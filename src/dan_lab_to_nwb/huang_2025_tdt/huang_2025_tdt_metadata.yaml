NWBFile:
  keywords:
    - fiber photometry
    - optogenetics
    - sleep
  session_description:
    Sleep-Wake experiments were conducted with mice while video, electrophysiology, and fiber photometry data were collected and optogenetic stimulation was delivered.
  institution: University of California Berkeley
  lab: Dan Lab
  experimenter:
    - Huang, Xiaolin
    - Dan, Yang
Subject:
  species: Mus musculus
  description: Mice were used for all experiments.

Ophys:
  FiberPhotometry:
    OpticalFiberModels:
    - name: optical_fiber_model_fiber_photometry
      description: The Splitter Branching Fiber-optic Patch Cord evenly splits the light from a large core diameter connectorized optical fiber into 2 or more branches of smaller core diameter connectorized optical fibers. A 15 cm long large core optical fiber helps obtain uniform distribution of light before a launch into 2 or more optical fibers bundled inside the central tubing. A 2-branch Splitter Branching Fiber-optic Patch Cord typically outputs around 16 % of the input power.
      manufacturer: Doric Lenses
      model_number: SBP(2)_200/220/900-0.37_1m_FCM-2xFCM, Splitter Branching Patchcord type A
      numerical_aperture: 0.37
      core_diameter_in_um: 200.0

    OpticalFibers:
    - name: optical_fiber_NAc
      description: Optical fiber used for fiber photometry recordings in the Nucleus Accumbens (NAc).
      model: optical_fiber_model_fiber_photometry
      fiber_insertion:
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: bregma
        hemisphere: right
        insertion_angle_pitch_in_deg: 0.0
        insertion_angle_yaw_in_deg: 0.0
        insertion_angle_roll_in_deg: 0.0
    - name: optical_fiber_BF
      description: Optical fiber used for fiber photometry recordings in the Basal Forebrain (BF).
      model: optical_fiber_model_fiber_photometry
      fiber_insertion:
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: bregma
        hemisphere: right
        insertion_angle_pitch_in_deg: 0.0
        insertion_angle_yaw_in_deg: 0.0
        insertion_angle_roll_in_deg: 0.0

    ExcitationSourceModels:
    - name: excitation_source_model
      description: Our next-generation RZ10x Fiber Photometry Processors feature new integrated LUX LEDs and Photosensors that plug directly into its front panel. The RZ10x can drive up to six LED light sources and collect fiber photometry data from up to four photosensors simultaneously. This allows for independent control of three-LED imaging from up to two sites or subjects.
      manufacturer: Tucker Davis Technologies
      model_number: RZ10X
      source_type: LED
      excitation_mode: one-photon
      wavelength_range_in_nm: [385, 940]

    ExcitationSources:
    - name: excitation_source
      description: Excitation source used for fiber photometry.
      model: excitation_source_model

    PhotodetectorModels:
    - name: photodetector_model
      description: Our next-generation RZ10x Fiber Photometry Processors feature new integrated LUX LEDs and Photosensors that plug directly into its front panel. The RZ10x can drive up to six LED light sources and collect fiber photometry data from up to four photosensors simultaneously. This allows for independent control of three-LED imaging from up to two sites or subjects.
      manufacturer: Tucker Davis Technologies
      model_number: RZ10X
      detector_type: photodiode
      wavelength_range_in_nm: [320, 1100]
      gain: 1.0e+10
      gain_unit: V/W

    Photodetectors:
    - name: photodetector
      description: Photodetector used for fiber photometry.
      model: photodetector_model

    FiberPhotometryViruses:
    - name: virus_da_NAc
      description: Expresses the 2nd generation high-affinity DA sensor GRAB_DA2h in neurons.
      manufacturer: Addgene
      construct_name: pAAV-hsyn-GRAB_DA2h
      titer_in_vg_per_ml: 2.0e+13
    - name: virus_5HT_BF
      description: Expresses GRAB-5HT sensor in neurons.
      manufacturer: WZ Biosciences
      construct_name: AAV9-hSyn-5HT3.0(5HT3.6)
      titer_in_vg_per_ml: 2.0e+13

    FiberPhotometryVirusInjections:
    - name: virus_injection_da_NAc
      description: Viral injection of virus_da_NAc into the Nucleus Accumbens (NAc).
      viral_vector: virus_da_NAc
      location: Nucleus Accumbens (NAc)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: -1.0 # TODO: Add AP coordinate
      ml_in_mm: -1.0 # TODO: Add ML coordinate
      dv_in_mm: -1.0 # TODO: Add DV coordinate
      volume_in_uL: 0.300
    - name: virus_injection_5HT_BF
      description: Viral injection of virus_5HT_BF into the Basal Forebrain (BF).
      viral_vector: virus_5HT_BF
      location: Basal Forebrain (BF)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: -1.0 # TODO: Add AP coordinate
      ml_in_mm: -1.0 # TODO: Add ML coordinate
      dv_in_mm: -1.0 # TODO: Add DV coordinate
      volume_in_uL: 0.300

    FiberPhotometryIndicators:
    - name: indicator_da_NAc
      description: Indicator for detecting dopamine levels in the Nucleus Accumbens (NAc).
      manufacturer: Addgene
      label: GRAB-DA2h
      viral_vector_injection: virus_injection_da_NAc
    - name: indicator_5HT_BF
      description: Indicator for detecting serotonin levels in the Basal Forebrain (BF).
      manufacturer: WZ Biosciences
      label: GRAB-5HT
      viral_vector_injection: virus_injection_5HT_BF



    FiberPhotometryTable:
      name: fiber_photometry_table
      description: Information about each fiber photometry recording site, including location, excitation wavelength, indicator, optical fiber, excitation source, and photodetector.
      rows:
      - name: 0
        location: Nucleus Accumbens (NAc)
        excitation_wavelength_in_nm: 465.0
        emission_wavelength_in_nm: 525.0
        indicator: indicator_da_NAc
        optical_fiber: optical_fiber_NAc
        excitation_source: excitation_source
        photodetector: photodetector
      - name: 1
        location: Nucleus Accumbens (NAc)
        excitation_wavelength_in_nm: 405.0
        emission_wavelength_in_nm: 525.0
        indicator: indicator_da_NAc
        optical_fiber: optical_fiber_NAc
        excitation_source: excitation_source
        photodetector: photodetector

      - name: 2
        location: Basal Forebrain (BF)
        excitation_wavelength_in_nm: 465.0
        emission_wavelength_in_nm: 525.0
        indicator: indicator_5HT_BF
        optical_fiber: optical_fiber_BF
        excitation_source: excitation_source
        photodetector: photodetector
      - name: 3
        location: Basal Forebrain (BF)
        excitation_wavelength_in_nm: 405.0
        emission_wavelength_in_nm: 525.0
        indicator: indicator_5HT_BF
        optical_fiber: optical_fiber_BF
        excitation_source: excitation_source
        photodetector: photodetector


    FiberPhotometryResponseSeries:
    - name: calcium_signal_NAc
      description: The fluorescence from the calcium signal from NAc.
      stream_name: _465B
      stream_indices: null
      unit: a.u.
      fiber_photometry_table_region: [0]
      fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the calcium signal of NAc.
    - name: isosbestic_control_NAc
      description: The fluorescence from the isosbestic control from NAc.
      stream_name: _405B
      stream_indices: null
      unit: a.u.
      fiber_photometry_table_region: [1]
      fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the isosbestic control of NAc.

    - name: calcium_signal_BF
      description: The fluorescence from the calcium signal from BF.
      stream_name: _465B
      stream_indices: null
      unit: a.u.
      fiber_photometry_table_region: [2]
      fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the calcium signal of BF.
    - name: isosbestic_control_BF
      description: The fluorescence from the isosbestic control from BF.
      stream_name: _405B
      stream_indices: null
      unit: a.u.
      fiber_photometry_table_region: [3]
      fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the isosbestic control of BF.

Behavior:
  ExternalVideos:
    VideoCamera1:
      description: Video recorded by camera 1.
      unit: Frames
      device:
        name: Camera1
        description: The B0205 is a new member of Arducam's USB camera family. Based on 1/2.7‚Äù OV2710, it's a 2MP, UVC-compliant, wide-angle USB 2.0 camera with a motorized IR-Cut filter and infrared LEDs. The motorized (switchable) IR-CUT filter and infrared LEDs can be triggered by the photoresistor according to the light environment to be ON/OFF to block or pass the infrared light. It can be widely used in wildlife photography, home security systems, baby cameras, etc.
        manufacturer: ArduCam
        model_name: 1080P Day & Night Vision USB Camera for Computer, 2MP Automatic IR-Cut Switching All-Day Image USB2.0 Webcam Board with IR LEDs for Windows, Linux, Android and Mac OS

Optogenetics:
  stimulation_software: TDT Synapse
  excitation_wavelength_in_nm: 635.0
  OptogeneticViruses:
    - name: virus
      description: pAAV-Syn-FLEX-rc[ChrimsonR-tdTomato] (AAV5) viral vector was used for optogenetic experiments.
      manufacturer: Addgene
      construct_name: pAAV-Syn-FLEX-rc[ChrimsonR-tdTomato] (AAV5)
      titer_in_vg_per_ml: 5.0e+12
  OptogeneticVirusInjections:
    - name: virus_injection_mVTA
      description: Viral injection into the Ventral Tegmental Area (VTA).
      viral_vector: virus
      location: Ventral Tegmental Area (VTA)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: -3.8
      ml_in_mm: 0.3
      dv_in_mm: -4.5
      volume_in_uL: 0.700
    - name: virus_injection_DRN
      description: Viral injection into the Dorsal Raphe Nucleus (DRN).
      viral_vector: virus
      location: Dorsal Raphe Nucleus (DRN)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: -1.0 # TODO: Add AP coordinate
      ml_in_mm: -1.0 # TODO: Add ML coordinate
      dv_in_mm: -1.0 # TODO: Add DV coordinate
      volume_in_uL: 0.700
    - name: virus_injection_BF
      description: Viral injection into the Basal Forebrain (BF).
      viral_vector: virus
      location: Basal Forebrain (BF)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: 0.1
      ml_in_mm: 1.5
      dv_in_mm: -5.3
      volume_in_uL: 0.700
    - name: virus_injection_LC
      description: Viral injection into the Locus Coeruleus (LC).
      viral_vector: virus
      location: Locus Coeruleus (LC)
      hemisphere: right
      reference: bregma at the cortical surface
      ap_in_mm: -5.5
      ml_in_mm: 0.9
      dv_in_mm: -3.6
      volume_in_uL: 0.700
  OptogeneticEffectors:
    - name: chrimsonR_mVTA
      description: ChrimsonR opsin used for optogenetic stimulation injected into the VTA.
      manufacturer: Addgene
      label: ChrimsonR
      viral_vector_injection: virus_injection_mVTA
    - name: chrimsonR_DRN
      description: ChrimsonR opsin used for optogenetic stimulation injected into the DRN.
      manufacturer: Addgene
      label: ChrimsonR
      viral_vector_injection: virus_injection_DRN
    - name: chrimsonR_BF
      description: ChrimsonR opsin used for optogenetic stimulation injected into the BF.
      manufacturer: Addgene
      label: ChrimsonR
      viral_vector_injection: virus_injection_BF
    - name: chrimsonR_LC
      description: ChrimsonR opsin used for optogenetic stimulation injected into the LC.
      manufacturer: Addgene
      label: ChrimsonR
      viral_vector_injection: virus_injection_LC
  ExcitationSourceModels:
    - name: optogenetic_excitation_source_model
      description: An LED device used for optogenetic stimulation.
      manufacturer: RWD Life Sciences
      model_number: MRL-III-635L-1-1
      source_type: LED
      excitation_mode: one-photon
  ExcitationSources:
    - name: optogenetic_excitation_source
      description: An LED device used for optogenetic stimulation.
      model: optogenetic_excitation_source_model
      power_in_W: 0.020 # 20mW
  OpticalFiberModels:
    - name: optical_fiber_model_optogenetics
      description: Optical fiber used for optogenetic stimulation.
      manufacturer: Doric Lenses
      model_number: MFP_200/220/900-0.37_2m_FC-FC_LAF
      numerical_aperture: 0.39
      core_diameter_in_um: 200.0
      ferrule_name: FC Connector with Zirconia Ferrule
      ferrule_model: FC
      ferrule_diameter_in_mm: 2.5
  OpticalFibers:
    - name: optical_fiber_mVTA
      description: Optical fiber used for optogenetic stimulation in the VTA.
      model: optical_fiber_model_optogenetics
      fiber_insertion: # TODO: add fiber insertion details
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: Bregma at the cortical surface
        hemisphere: right # TODO: get hemisphere from a subject-wise map
        insertion_angle_pitch_in_deg: 0.0 # TODO: add pitch angle
        insertion_angle_yaw_in_deg: 0.0 # TODO: add yaw angle
        insertion_angle_roll_in_deg: 0.0 # TODO: add roll angle
    - name: optical_fiber_DRN
      description: Optical fiber used for optogenetic stimulation in the DRN.
      model: optical_fiber_model_optogenetics
      fiber_insertion:
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: Bregma at the cortical surface
        hemisphere: right # TODO: get hemisphere from a subject-wise map
        insertion_angle_pitch_in_deg: 0.0 # TODO: add pitch angle
        insertion_angle_yaw_in_deg: 0.0 # TODO: add yaw angle
        insertion_angle_roll_in_deg: 0.0 # TODO: add roll angle
    - name: optical_fiber_BF
      description: Optical fiber used for optogenetic stimulation in the BF.
      model: optical_fiber_model_optogenetics
      fiber_insertion:
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: Bregma at the cortical surface
        hemisphere: right # TODO: get hemisphere from a subject-wise map
        insertion_angle_pitch_in_deg: 0.0 # TODO: add pitch angle
        insertion_angle_yaw_in_deg: 0.0 # TODO: add yaw angle
        insertion_angle_roll_in_deg: 0.0 # TODO: add roll angle
    - name: optical_fiber_LC
      description: Optical fiber used for optogenetic stimulation in the LC.
      model: optical_fiber_model_optogenetics
      fiber_insertion:
        depth_in_mm: -1.0 # TODO: add depth in mm
        insertion_position_ap_in_mm: -1.0 # TODO: add AP coordinate
        insertion_position_ml_in_mm: -1.0 # TODO: add ML coordinate
        insertion_position_dv_in_mm: -1.0 # TODO: add DV coordinate
        position_reference: Bregma at the cortical surface
        hemisphere: right # TODO: get hemisphere from a subject-wise map
        insertion_angle_pitch_in_deg: 0.0 # TODO: add pitch angle
        insertion_angle_yaw_in_deg: 0.0 # TODO: add yaw angle
        insertion_angle_roll_in_deg: 0.0 # TODO: add roll angle
  OptogeneticSitesTable:
    description: Information about each optogenetic site, including the excitation source, optical fiber, and targeted effector.
    reference: Bregma at the cortical surface
    rows:
      - name: mVTA
        excitation_source: optogenetic_excitation_source
        optical_fiber: optical_fiber_mVTA
        effector: chrimsonR_mVTA
      - name: DRN
        excitation_source: optogenetic_excitation_source
        optical_fiber: optical_fiber_DRN
        effector: chrimsonR_DRN
      - name: BF
        excitation_source: optogenetic_excitation_source
        optical_fiber: optical_fiber_BF
        effector: chrimsonR_BF
      - name: LC
        excitation_source: optogenetic_excitation_source
        optical_fiber: optical_fiber_LC
        effector: chrimsonR_LC

Ecephys:
  Device:
    - name: DeviceEEG
      description: EEG electrodes consist of 2 wires with 0.002 inch diameter made of stainless steel wrapped around a metal screw inserted into the brain 2.5mm lateral to the midline, 3mm posterior to bregma.
      manufacturer: Dan Lab
    - name: DeviceEMG
      description: EMG electrodes consist of 2 wires with 0.002 inch diameter made of stainless steel inserted subcutaneously in the neck.
      manufacturer: Dan Lab
  ElectrodeGroup:
    - name: ElectrodeGroupEEG
      description: ElectrodeGroup for EEG channels.
      device: DeviceEEG
      location: 2.5mm lateral to the midline, 3mm posterior to bregma.
    - name: ElectrodeGroupEMG
      description: ElectrodeGroup for EMG channels.
      device: DeviceEMG
      location: Subcutaneous neck
  ElectricalSeriesEEG:
    name: ElectricalSeriesEEG
    description: EEG voltage data recorded by a TDT acquisition system.
    filtering: The data was band-pass filtered between 0.5 Hz and 750 Hz using second-order filters. Notch filters were applied at 60 Hz, 120 Hz, 180 Hz, and 240 Hz with 20 dB attenuation and 1/10th octave bandwidth to remove power line interference and its harmonics.
  ElectricalSeriesEMG:
    name: ElectricalSeriesEMG
    description: EMG voltage data recorded by a TDT acquisition system.
    filtering: The data was band-pass filtered between 0.5 Hz and 750 Hz using second-order filters. Notch filters were applied at 60 Hz, 120 Hz, 180 Hz, and 240 Hz with 20 dB attenuation and 1/10th octave bandwidth to remove power line interference and its harmonics.
